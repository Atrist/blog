<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>review-017 | Atrist</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="icon" href="/blog/h1.png">
    <link rel="alternate" type="application/rss+xml" href="https://atrist.github.io/blog/rss.xml" title="Atrist RSS Feed">
    <link rel="alternate" type="application/atom+xml" href="https://atrist.github.io/blog/feed.atom" title="Atrist Atom Feed">
    <link rel="alternate" type="application/json" href="https://atrist.github.io/blog/feed.json" title="Atrist JSON Feed">
    <meta name="description" content="以面试题来驱动学习,每天进步一点！">
    
    <link rel="preload" href="/blog/assets/css/0.styles.b5c0c7a6.css" as="style"><link rel="preload" href="/blog/assets/js/app.db86d5f6.js" as="script"><link rel="preload" href="/blog/assets/js/14.b92fad15.js" as="script"><link rel="preload" href="/blog/assets/js/4.c843a5e7.js" as="script"><link rel="preload" href="/blog/assets/js/7.a59c3076.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.e1b2ab49.js"><link rel="prefetch" href="/blog/assets/js/100.ccfb528a.js"><link rel="prefetch" href="/blog/assets/js/101.1cff0245.js"><link rel="prefetch" href="/blog/assets/js/102.73cab9a3.js"><link rel="prefetch" href="/blog/assets/js/103.9d5b8a52.js"><link rel="prefetch" href="/blog/assets/js/104.9e71a128.js"><link rel="prefetch" href="/blog/assets/js/105.8b16a8bc.js"><link rel="prefetch" href="/blog/assets/js/106.f49c2272.js"><link rel="prefetch" href="/blog/assets/js/107.4c21d5d5.js"><link rel="prefetch" href="/blog/assets/js/108.d167d434.js"><link rel="prefetch" href="/blog/assets/js/109.3e3e241b.js"><link rel="prefetch" href="/blog/assets/js/11.5ed66461.js"><link rel="prefetch" href="/blog/assets/js/110.ead85efd.js"><link rel="prefetch" href="/blog/assets/js/111.02c0cb86.js"><link rel="prefetch" href="/blog/assets/js/112.a7c28091.js"><link rel="prefetch" href="/blog/assets/js/113.e836d3e8.js"><link rel="prefetch" href="/blog/assets/js/114.1313f8ce.js"><link rel="prefetch" href="/blog/assets/js/115.edd50758.js"><link rel="prefetch" href="/blog/assets/js/116.34de5941.js"><link rel="prefetch" href="/blog/assets/js/117.442013ed.js"><link rel="prefetch" href="/blog/assets/js/118.8b04fb40.js"><link rel="prefetch" href="/blog/assets/js/119.62e884e2.js"><link rel="prefetch" href="/blog/assets/js/12.e8626bf6.js"><link rel="prefetch" href="/blog/assets/js/120.73271408.js"><link rel="prefetch" href="/blog/assets/js/121.b4507e49.js"><link rel="prefetch" href="/blog/assets/js/122.c7ff47db.js"><link rel="prefetch" href="/blog/assets/js/123.88bae681.js"><link rel="prefetch" href="/blog/assets/js/124.b06600ce.js"><link rel="prefetch" href="/blog/assets/js/125.61ce47d8.js"><link rel="prefetch" href="/blog/assets/js/126.31d6299c.js"><link rel="prefetch" href="/blog/assets/js/127.400408a6.js"><link rel="prefetch" href="/blog/assets/js/128.f2077bdf.js"><link rel="prefetch" href="/blog/assets/js/129.830544e0.js"><link rel="prefetch" href="/blog/assets/js/13.94b63353.js"><link rel="prefetch" href="/blog/assets/js/130.37541765.js"><link rel="prefetch" href="/blog/assets/js/131.00b837cd.js"><link rel="prefetch" href="/blog/assets/js/132.3d651b48.js"><link rel="prefetch" href="/blog/assets/js/133.06478568.js"><link rel="prefetch" href="/blog/assets/js/134.21c0ee37.js"><link rel="prefetch" href="/blog/assets/js/135.503a5066.js"><link rel="prefetch" href="/blog/assets/js/136.d3d35d16.js"><link rel="prefetch" href="/blog/assets/js/137.ade7cbf9.js"><link rel="prefetch" href="/blog/assets/js/138.618000df.js"><link rel="prefetch" href="/blog/assets/js/139.9bfdc6b6.js"><link rel="prefetch" href="/blog/assets/js/140.f0d2f034.js"><link rel="prefetch" href="/blog/assets/js/141.2d8d1d76.js"><link rel="prefetch" href="/blog/assets/js/142.93d2a7ea.js"><link rel="prefetch" href="/blog/assets/js/143.c1053ed6.js"><link rel="prefetch" href="/blog/assets/js/144.757141d3.js"><link rel="prefetch" href="/blog/assets/js/145.b0f56a59.js"><link rel="prefetch" href="/blog/assets/js/146.2f2313f7.js"><link rel="prefetch" href="/blog/assets/js/147.49e728ff.js"><link rel="prefetch" href="/blog/assets/js/148.24c95a52.js"><link rel="prefetch" href="/blog/assets/js/15.be67a448.js"><link rel="prefetch" href="/blog/assets/js/16.402064f0.js"><link rel="prefetch" href="/blog/assets/js/17.5fa16584.js"><link rel="prefetch" href="/blog/assets/js/18.80dd2f19.js"><link rel="prefetch" href="/blog/assets/js/19.7fa223e5.js"><link rel="prefetch" href="/blog/assets/js/20.7bbb4ded.js"><link rel="prefetch" href="/blog/assets/js/21.69cb97ee.js"><link rel="prefetch" href="/blog/assets/js/22.be011b39.js"><link rel="prefetch" href="/blog/assets/js/23.f9023eb6.js"><link rel="prefetch" href="/blog/assets/js/24.d68c9c20.js"><link rel="prefetch" href="/blog/assets/js/25.22db9bed.js"><link rel="prefetch" href="/blog/assets/js/26.ea9a3838.js"><link rel="prefetch" href="/blog/assets/js/27.66fffdf3.js"><link rel="prefetch" href="/blog/assets/js/28.a859f5a8.js"><link rel="prefetch" href="/blog/assets/js/29.aa1be156.js"><link rel="prefetch" href="/blog/assets/js/30.1bcb996d.js"><link rel="prefetch" href="/blog/assets/js/31.b84a8132.js"><link rel="prefetch" href="/blog/assets/js/32.db2c8c50.js"><link rel="prefetch" href="/blog/assets/js/33.32617e4b.js"><link rel="prefetch" href="/blog/assets/js/34.c00a806f.js"><link rel="prefetch" href="/blog/assets/js/35.e7f4ea1f.js"><link rel="prefetch" href="/blog/assets/js/36.a0e0afba.js"><link rel="prefetch" href="/blog/assets/js/37.a47a45e8.js"><link rel="prefetch" href="/blog/assets/js/38.dc7a779d.js"><link rel="prefetch" href="/blog/assets/js/39.40da6a6d.js"><link rel="prefetch" href="/blog/assets/js/40.44a9f54a.js"><link rel="prefetch" href="/blog/assets/js/41.9327477f.js"><link rel="prefetch" href="/blog/assets/js/42.7cf81c78.js"><link rel="prefetch" href="/blog/assets/js/43.6acc348e.js"><link rel="prefetch" href="/blog/assets/js/44.ad085ddc.js"><link rel="prefetch" href="/blog/assets/js/45.99da8837.js"><link rel="prefetch" href="/blog/assets/js/46.c1b41ada.js"><link rel="prefetch" href="/blog/assets/js/47.87152bc8.js"><link rel="prefetch" href="/blog/assets/js/48.a67fa1bc.js"><link rel="prefetch" href="/blog/assets/js/49.1cd3515d.js"><link rel="prefetch" href="/blog/assets/js/5.0a3cf159.js"><link rel="prefetch" href="/blog/assets/js/50.be758377.js"><link rel="prefetch" href="/blog/assets/js/51.990581ee.js"><link rel="prefetch" href="/blog/assets/js/52.2a10b7b8.js"><link rel="prefetch" href="/blog/assets/js/53.9ca8e8ac.js"><link rel="prefetch" href="/blog/assets/js/54.8abae8b5.js"><link rel="prefetch" href="/blog/assets/js/55.d6a8021c.js"><link rel="prefetch" href="/blog/assets/js/56.f2f1081d.js"><link rel="prefetch" href="/blog/assets/js/57.bb63066b.js"><link rel="prefetch" href="/blog/assets/js/58.aa9f3eb2.js"><link rel="prefetch" href="/blog/assets/js/59.1f1e2eca.js"><link rel="prefetch" href="/blog/assets/js/6.e9e6bed3.js"><link rel="prefetch" href="/blog/assets/js/60.00527494.js"><link rel="prefetch" href="/blog/assets/js/61.94606c8f.js"><link rel="prefetch" href="/blog/assets/js/62.314bb6df.js"><link rel="prefetch" href="/blog/assets/js/63.42e2dc26.js"><link rel="prefetch" href="/blog/assets/js/64.c63f8703.js"><link rel="prefetch" href="/blog/assets/js/65.880e3e5f.js"><link rel="prefetch" href="/blog/assets/js/66.2fd9094d.js"><link rel="prefetch" href="/blog/assets/js/67.2236a5ff.js"><link rel="prefetch" href="/blog/assets/js/68.3e842c76.js"><link rel="prefetch" href="/blog/assets/js/69.2f220b9e.js"><link rel="prefetch" href="/blog/assets/js/70.f1bae73e.js"><link rel="prefetch" href="/blog/assets/js/71.bebea812.js"><link rel="prefetch" href="/blog/assets/js/72.2f35d215.js"><link rel="prefetch" href="/blog/assets/js/73.f1746d2c.js"><link rel="prefetch" href="/blog/assets/js/74.65677dd8.js"><link rel="prefetch" href="/blog/assets/js/75.d32852ff.js"><link rel="prefetch" href="/blog/assets/js/76.92d56a00.js"><link rel="prefetch" href="/blog/assets/js/77.620e9796.js"><link rel="prefetch" href="/blog/assets/js/78.a1f2dd8d.js"><link rel="prefetch" href="/blog/assets/js/79.afb8422b.js"><link rel="prefetch" href="/blog/assets/js/8.e43b25f0.js"><link rel="prefetch" href="/blog/assets/js/80.a5ea4ceb.js"><link rel="prefetch" href="/blog/assets/js/81.ce311f65.js"><link rel="prefetch" href="/blog/assets/js/82.88240721.js"><link rel="prefetch" href="/blog/assets/js/83.59b74c06.js"><link rel="prefetch" href="/blog/assets/js/84.26f13d5d.js"><link rel="prefetch" href="/blog/assets/js/85.1f8ce80c.js"><link rel="prefetch" href="/blog/assets/js/86.7e812dcf.js"><link rel="prefetch" href="/blog/assets/js/87.f6225376.js"><link rel="prefetch" href="/blog/assets/js/88.02caddde.js"><link rel="prefetch" href="/blog/assets/js/89.88de4b54.js"><link rel="prefetch" href="/blog/assets/js/9.8e8b4475.js"><link rel="prefetch" href="/blog/assets/js/90.0da833fa.js"><link rel="prefetch" href="/blog/assets/js/91.81b53e64.js"><link rel="prefetch" href="/blog/assets/js/92.d03f8d20.js"><link rel="prefetch" href="/blog/assets/js/93.539ec474.js"><link rel="prefetch" href="/blog/assets/js/94.1f53506a.js"><link rel="prefetch" href="/blog/assets/js/95.96e21733.js"><link rel="prefetch" href="/blog/assets/js/96.34c014c1.js"><link rel="prefetch" href="/blog/assets/js/97.2344448b.js"><link rel="prefetch" href="/blog/assets/js/98.729f005b.js"><link rel="prefetch" href="/blog/assets/js/99.1326c1c4.js"><link rel="prefetch" href="/blog/assets/js/vendors~flowchart.6e56b3f0.js"><link rel="prefetch" href="/blog/assets/js/vuejs-paginate.00251aa4.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.b5c0c7a6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-blog__global-layout"><section id="header-wrapper"><header id="header"><div class="header-wrapper"><div class="title"><a href="/blog/" class="nav-link home-link">Atrist </a></div> <div class="header-right-wrap"><ul class="nav"><li class="nav-item"><a href="/blog/" class="nav-link">Blog</a></li><li class="nav-item"><a href="/blog/tag/" class="nav-link">Tags</a></li><li class="nav-item"><a href="/blog/1970/01/01/resume/" class="nav-link">Resume</a></li><li class="nav-item"><a href="https://github.com/Atrist" target="_blank" rel="noopener noreferrer" class="nav-link external">Github</a></li></ul> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></div></header></section> <div id="mobile-header"><div class="mobile-header-bar"><div class="mobile-header-title"><a href="/blog/" class="nav-link mobile-home-link">Atrist </a> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div> <div class="mobile-menu-wrapper"><hr class="menu-divider"> <ul class="mobile-nav"><li class="mobile-nav-item"><a href="/blog/" class="nav-link">Blog</a></li><li class="mobile-nav-item"><a href="/blog/tag/" class="nav-link">Tags</a></li><li class="mobile-nav-item"><a href="/blog/1970/01/01/resume/" class="nav-link">Resume</a></li><li class="mobile-nav-item"><a href="https://github.com/Atrist" target="_blank" rel="noopener noreferrer" class="nav-link external">Github</a></li> <li class="mobile-nav-item"><!----></li></ul></div></div></div> <div class="content-wrapper"><div id="vuepress-theme-blog__post-layout"><article itemscope="itemscope" itemtype="https://schema.org/BlogPosting" class="vuepress-blog-theme-content"><header><h1 itemprop="name headline" class="post-title">
        review-017
      </h1> <div class="post-meta"><div itemprop="publisher author" itemtype="http://schema.org/Person" itemscope="itemscope" class="post-meta-author"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-navigation"><polygon points="3 11 22 2 13 21 11 13 3 11"></polygon></svg> <span itemprop="name">Atrist</span> <!----></div> <div class="post-meta-date"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> <time pubdate itemprop="datePublished" datetime="2020-8-14">
      Fri Aug 14 2020
    </time></div> <ul itemprop="keywords" class="post-meta-tags"><li class="post-tag" data-v-42ccfcd5><a href="/blog/tag/web" data-v-42ccfcd5><span data-v-42ccfcd5>web</span></a></li><li class="post-tag" data-v-42ccfcd5><a href="/blog/tag/html" data-v-42ccfcd5><span data-v-42ccfcd5>html</span></a></li><li class="post-tag" data-v-42ccfcd5><a href="/blog/tag/css" data-v-42ccfcd5><span data-v-42ccfcd5>css</span></a></li><li class="post-tag" data-v-42ccfcd5><a href="/blog/tag/js" data-v-42ccfcd5><span data-v-42ccfcd5>js</span></a></li><li class="post-tag" data-v-42ccfcd5><a href="/blog/tag/review" data-v-42ccfcd5><span data-v-42ccfcd5>review</span></a></li></ul></div></header> <div itemprop="articleBody" class="content__default"><h2 id="参考资料"><a href="#参考资料" class="header-anchor">#</a> 参考资料</h2> <ol><li><a href="https://github.com/haizlin/fe-interview/blob/master/category/history.md" target="_blank" rel="noopener noreferrer">前端面试每日 3+1<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/Advanced-Frontend/Daily-Interview-Question/blob/master/datum/summary.md" target="_blank" rel="noopener noreferrer">Daily-Interview-Question<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.csdn.net/sunnyjingqi/article/details/83064872" target="_blank" rel="noopener noreferrer">CSS Sprites 精灵图 samllplum<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://juejin.im/post/6844903731704791054" target="_blank" rel="noopener noreferrer">作为前端的你了解多少 tcp 的内容 Guokai<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ol> <h2 id="html-你认为-table-的作用和优缺点是什么呢"><a href="#html-你认为-table-的作用和优缺点是什么呢" class="header-anchor">#</a> [html] 你认为 table 的作用和优缺点是什么呢？</h2> <h3 id="table-布局"><a href="#table-布局" class="header-anchor">#</a> table 布局</h3> <h4 id="优点"><a href="#优点" class="header-anchor">#</a> 优点</h4> <ol><li>对于新手而言，容易上手，尤其对于一些布局中规中矩的网页，更让人首先想到 <code>excel</code>，进而通过使用 <code>table</code> 去实现它。</li> <li>表现上更加“严谨”，在不同浏览器中都能得到很好的兼容</li> <li>通过复杂的表格套表格的形式，也可以实现比较复杂的布局需求。布置好表格，然后将内容放进去就可以了。</li> <li>它可以不用顾及垂直居中的问题。</li> <li>数据化的存放更合理。</li></ol> <h4 id="缺点"><a href="#缺点" class="header-anchor">#</a> 缺点</h4> <ol><li>标签结构多，复杂，在表格布局中，主要是用到表格的相互嵌套使用，这样就会造成代码的复杂度更高！</li> <li>表格布局，不利于搜索引擎抓取信息，直接影响到网站的排名</li></ol> <h2 id="css-解释下-css-sprites-的原理和优缺点分别是什么"><a href="#css-解释下-css-sprites-的原理和优缺点分别是什么" class="header-anchor">#</a> [css] 解释下 CSS sprites 的原理和优缺点分别是什么？</h2> <h3 id="_1-简介"><a href="#_1-简介" class="header-anchor">#</a> 1. 简介</h3> <p>CSS Sprites 在国内很多人叫 css 精灵，是一种网页图片应用处理方式。它允许将一个页面涉及到的所有零星图片都包含到一张大图中， 利用 CSS 的<code>“background-image”</code>，<code>“background- repeat”</code>，<code>“background-position”</code>的组合进行背景定位， 访问页面时避免图片载入缓慢的现象。</p> <h3 id="_2-优点"><a href="#_2-优点" class="header-anchor">#</a> 2. 优点</h3> <ol><li><code>CSS Sprites</code> 能很好地减少网页的 <code>http</code> 请求，从而大大的提高页面的性能，这是 <code>CSS Sprites</code> 最大的优点，也是其被广泛传播和应用的主要原因；</li> <li><code>CSS Sprites</code> 能减少图片的字节；</li> <li><code>CSS Sprites</code> 解决了网页设计师在图片命名上的困扰，只需对一张集合的图片命名，不需要对每一个小图片进行命名，从而提高了网页制作效率。</li> <li><code>CSS Sprites</code> 只需要修改一张或少张图片的颜色或样式来改变整个网页的风格。</li></ol> <h3 id="_3-缺点"><a href="#_3-缺点" class="header-anchor">#</a> 3.缺点</h3> <ol><li><strong>图片合并麻烦</strong>：图片合并时，需要把多张图片有序的合理的合并成一张图片，并留好足够的空间防止版块出现不必要的背景。</li> <li><strong>图片适应性差</strong>：在高分辨的屏幕下自适应页面，若图片不够宽会出现背景断裂。</li> <li><strong>图片定位繁琐</strong>：开发时需要通过工具测量计算每个背景单元的精确位置。</li> <li><strong>可维护性差</strong>：页面背景需要少许改动，可能要修改部分或整张已合并的图片，进而要改动 css。在避免改动图片的前提下，又只能（最好）往下追加图片，但这样增加了图片字节。</li></ol> <h2 id="js-typeof-abc-和-typeof-abc-都是-string-那么-typeof-是操作符还是函数"><a href="#js-typeof-abc-和-typeof-abc-都是-string-那么-typeof-是操作符还是函数" class="header-anchor">#</a> [js] typeof('abc')和 typeof 'abc'都是 string, 那么 typeof 是操作符还是函数？</h2> <p><code>typeof</code> 是操作符, 此时的括号, 表达的是 <code>('abc')</code>, 而并不是 <code>typeof</code> 的括号.</p> <h2 id="谈谈你对-tcp-三次握手和四次挥手的理解"><a href="#谈谈你对-tcp-三次握手和四次挥手的理解" class="header-anchor">#</a> 谈谈你对 TCP 三次握手和四次挥手的理解</h2> <h3 id="base"><a href="#base" class="header-anchor">#</a> base</h3> <p>OSI(Open Systems Interconncection，开放系统互联)网络分层
从上到下分别是：</p> <ol><li>应用层(<code>Application</code>)</li> <li>表示层(<code>Presentation</code>)</li> <li>会话层(<code>Session</code>)</li> <li>传输层(<code>Transport</code>)</li> <li>网络层<code>(Network</code>) -- 路由器</li> <li>数据链路层(<code>Data Link</code>) -- 交换机</li> <li>物理层(<code>Physical</code>) -- 网卡、集线器（<code>Hub</code>）</li></ol> <p>基础内容不做过多的讲解，有需要的可以<a href="https://juejin.im/post/6844903568860774408" target="_blank" rel="noopener noreferrer">出门右转<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ok 我们今天主要关注的是 tcp 层的内容，下面的内容，如果有兴趣建议大家按照步骤实际操作去看看，首先介绍一个工具 <code>wireshark</code>，这个工具可以帮助我们抓到 <code>tcp</code> 以及更底层的包，下载到<a href="https://www.wireshark.org/" target="_blank" rel="noopener noreferrer">这里<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>,打开后有个 <code>download</code>，下载自己系统能用的就好，一路安装到全部完成，接下来我们开始一次实战抓包。</p> <h3 id="抓包"><a href="#抓包" class="header-anchor">#</a> 抓包</h3> <p>我这里利用了<a href="https://www.baidu.com/" target="_blank" rel="noopener noreferrer">百度的首页<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>做了一次抓包实验，首先要设置一个过滤</p> <p><img src="/blog/assets/img/1677d742cfd862ff.48a59b86.png" alt=""></p> <p>你可以选择 <code>http</code> 和 <code>tcp</code> 或者 <code>tcp only</code></p> <p><img src="/blog/assets/img/1677d747c82f3b44.e6800bcb.png" alt=""></p> <p>然后到控制台中去 ping 一下百度首页的 ip</p> <p><img src="/blog/assets/img/1677d7bb094ef050.0635a608.png" alt=""></p> <p>ok 看到 ip 是 <code>180.97.33.108</code></p> <p>然后我们到 <code>wireshark</code> 中设置一下查询的 <code>ip</code></p> <p><img src="/blog/assets/img/1677d7bec10cb2fc.c19173ba.png" alt=""></p> <p>到 chrome 中打开百度的首页，然后就能看到 tcp 的传输信息了</p> <p><img src="/blog/assets/img/1677d7cb94290fed.d0b365d8.png" alt=""></p> <p>内容有点多，我们通过这个内容来观察一下 tcp 的传输过程</p> <h3 id="tcp-base"><a href="#tcp-base" class="header-anchor">#</a> tcp base</h3> <p>先看下 tcp 的头部报文结构</p> <p><img src="/blog/assets/img/1677d4e5cbe9cba6.7c273a26.png" alt=""></p> <ol><li><code>tcp</code> 协议层是不关心 <code>ip</code> 的，具体 <code>ip</code> 的定位是由 <code>ip</code> 层来决定的，但是 <code>tcp</code> 层需要确定端口号，所以他会携带 <code>source</code> 和 <code>destination</code> 的 <code>port</code> 信息，以便能找到对应的端口号；</li> <li><code>sequence number</code> 实际中使用的 <code>SEQ</code>，也就是序号，这个序号起了很重要的作用，我们都知道 <code>tcp</code> 和 <code>udp</code> 最大的区别在于 <code>tcp</code> 是稳定并且有序的，其中 seq 就可以保证有序，当 <code>A</code> 向 <code>B</code> 发送一个数据包的时候，<code>seq</code> 会叠加，每一个传输方在传送数据的时候都会带上这个信息，另一端能按照这个序号来排序收到信息的顺序，从未保证了信息的传递是有序的，也能通过它来确认有没有出现丢包的情况；另外要注意的是当有数据需要发送的时候，<code>seq</code> 会随该序列号为原点，对自己将要发送的每个字节的数据进行编号，比如当前 <code>seq = 10</code>，本次要发送的数据包大小是 <code>200</code> 字节，那么实际发送的时候会更新 <code>seq=210</code>，以便保证传输的数据的顺序；</li> <li><code>acknowledge number</code>，实际中使用的 <code>ACK</code>，是另一端对对方 se<code>q 的一个回应，一般会把对方给的</code>seq+1` 然后下一次发包的时候带上，这样的话对方就知道我们是收到前面的消息的；</li> <li><code>windown</code> 代表的是滑动窗口，实际中用 <code>win</code> 来表示，<code>win</code> 的大小很重要，<code>win</code> 越大的传输越快，因为 <code>win</code> 的大小直接决定了某一端一次可以同时发送多少个数据包，而不用等待对方的应答 <code>ACK</code> 回来，但是 <code>win</code> 会随着每一个数据包的发送而变小(稍后解释)；</li> <li><code>reserved</code> 是 <code>tcp</code> 传输很重要的角色，标志位，响应方会根据对方给的信号执行对应的操作，比如执行断开连接的时候一般都是使用 <code>FIN</code> 标志位；</li></ol> <p>基础内容不做过多介绍，不懂的可以移步<a href="https://blog.csdn.net/jijianshuai/article/details/80883091" target="_blank" rel="noopener noreferrer">这里<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>先看下概念，后面我们会结合实际来介绍</p> <h3 id="三次握手-敲黑板"><a href="#三次握手-敲黑板" class="header-anchor">#</a> 三次握手(敲黑板)</h3> <p><img src="/blog/assets/img/1677d7d27b90efa4.8569322f.png" alt="">
观察前几次传输，<code>TLS</code> 类型的我们可以先忽略，它是处理 <code>ssl</code> 加密的内容，有兴趣的可以自己去 <code>google</code>，重点看前三次的 <code>tcp</code>，第一次是我们自己的 <code>ip</code> 向百度的服务器 <code>ip</code> 发了第一个包，<code>seq=0</code>，起始的数据信号是 <code>0，win=65535</code> 代表我这边的窗口大小是 <code>65535，len=0</code> 代表我这边希望接受的包的大小长度是 <code>0</code>，<code>mss</code> 代表我这边本次传输能接收的最大包的内容是 1460(其余的我们暂时不用关心)。</p> <p>下面我们模拟一下对话内容：</p> <p>A：B，你好，我是 A 请求建立连接，我的 seq 是 0，我的 win 是 65535，我希望本次回应我的内容长度 len 为 0，我本次能接收的最大内容是 1460，over；<br>
B：A，你也好，收到你的信息了，我是 B，我本次的 seq 是 0（注意，双方的序号是独立计算的，这里都从 0 开始的），我回应你的 ack 是 1(A 的 seq+1，代表我收到你 seq 是 0 的消息了)，我的窗口大小是 8192，我希望你回应我本次消息的 len 也是 0，我这边能接收的最大回应大小是 1452，over；<br>
A：好的，我收到你的回应了，我现在给你发送的 seq 是 1(上一次是 0，这次是 1)，我回应你的 ack 是 1(B 的 seq+1)，我当前的窗口大小是 25984，我希望的回应长度是 0；我们建立好连接了，over；<br>
到这里，完整的三次握手就结束了，后面就可以执行别的数据传输了，到这里，不知道有没有想过，为什么确定一次连接需要三次握手，不是 1 次，也不是 2 次，也不是 4 次，</p> <p><strong>首先，1 次肯定不行，1 次的话 一方无法确认另一方的情况，所以最少都是 2 次起步，</strong></p> <h4 id="_2-次"><a href="#_2-次" class="header-anchor">#</a> 2 次：</h4> <p>A：喂喂喂，我是 A，你听的到吗？<br>
B：在在在，我能听到，我是 B，你能听到我吗?<br>
A：(听到了，老子不想理你)<br>
B：喂喂喂？听不听到？我 X，对面死了，我挂了。。<br></p> <h4 id="_4-次"><a href="#_4-次" class="header-anchor">#</a> 4 次：</h4> <p>A：喂喂喂，我是 A，你听的到吗？<br>
B：在在在，我能听到，我是 B，你能听到我吗?<br>
A：听到了，你呢？你能听到吗？<br>
B：？？你是智障？我不是说了我能听到吗，不想跟 xx 说话。。。<br></p> <p><strong>所以最合理的还是 3 次：</strong></p> <p>A：喂喂喂，我是 A，你听的到吗？<br>
B：在在在，我能听到，我是 B，你能听到我吗?<br>
A：听到了。我们今天去钓鱼吧。。balabala<br>
so，就是这样，其实不是不能更多，但是可靠的同时，还要考虑性能和时间问题，所以，目前公认的握手次数还是三次比较合理。</p> <h3 id="四次挥手"><a href="#四次挥手" class="header-anchor">#</a> 四次挥手</h3> <p>我们知道 <code>tcp</code> 的连接是全双工的，<code>A</code> 和 <code>B</code> 是可以互相通信的，不理解的话，可以想想打电话（类比，不要当真），打电话的场景就是单双工的，因为同一时间只能一个人说话，另一个人听，如果 2 个人一起说话，那谁都听不清楚了，没有意义，但是 <code>tcp</code> 是全双工的，就是 <code>A</code>正在给 <code>B</code> 发信息的同时，<code>B</code> 也在给 <code>A</code> 发信息，所以当断开的时候，必须要求双方都得知道，如果只有一方知道，肯定不行，因此，断开的时候，就需要下面这样：</p> <p><img src="data:image/png;base64,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" alt=""></p> <p>A：B，不好意思，我这边需要关闭连接了，你准备一下？(发了一个 fin 信号给 B，等待回应)<br>
B：好的 A，我收到你的关闭信号了，我还有数据没发好，你等我下（回应 A，带回去 ACK 的最后一个信息，失败可以重发）<br>
B：A 老弟，我好了，我可以关闭了，给你最后说一下，等下你回应我的话，我就直接关了；<br>
A：好的老哥，我回应你一下，你收到就关闭吧，不用理我(发完这条信息后，进入 time_wait 状态)<br>
B：(收到 ack 信息，直接就关闭了)，此过程不产生数据的交互，不算挥手次数<br>
A：等待 2MSL(最大报文段生存时间)后，B 没东西给过来，我也关了；<br></p> <p>到这里 4 次挥手就结束了，2 个问题：</p> <h4 id="_1-为什么握手需要三次-而挥手却需要四次"><a href="#_1-为什么握手需要三次-而挥手却需要四次" class="header-anchor">#</a> 1.为什么握手需要三次，而挥手却需要四次？</h4> <p>握手的时候，<code>A</code> 和 <code>B</code> 打个招呼，<code>B</code> 可以直接把自己的 <code>SYN</code> 信息和对 <code>A</code> 的回应 <code>ACK</code> 信息一起带上，但是挥手的时候，<code>A</code>说我要断开了，<code>B</code> 还没发完最后的数据，因此需要先回应一下 <code>A</code>，我收到你的断开的请求了，但是你要等我把最后的内容给你，所以这里分开了 2 步：</p> <ol><li>回应 A；</li> <li>发送自己的最后一个数据</li></ol> <h4 id="_2-为什么-a-进入-time-wait-需要等待最大报文段生存的时间后-才能关闭"><a href="#_2-为什么-a-进入-time-wait-需要等待最大报文段生存的时间后-才能关闭" class="header-anchor">#</a> 2.为什么 A 进入 <code>TIME_WAIT</code> 需要等待最大报文段生存的时间后，才能关闭？</h4> <p>原因是，担心网络不可靠而导致的丢包，最后一个回应 <code>B</code> 的 <code>ACK</code> 万一丢了怎么办，在这个时间内，<code>A</code> 是可以重新发包的，但是超过了最大等待时间的话，就算收不到也没用了，所以就可以关闭了</p> <h3 id="如何理解滑动窗口的作用"><a href="#如何理解滑动窗口的作用" class="header-anchor">#</a> 如何理解滑动窗口的作用？</h3> <p>从上面的内容，我们简单了解了三次握手和四次挥手的内容，然后也知道了一些报文字段的意义，但是网络本身是不稳定的，也就是说中间无法保证数据包一定会到对面，那么 <code>tcp</code> 是如何在尽可能少的时间内实现稳定和有序传输的？</p> <p>我们知道 <code>SYN</code> 信息中会带上自己的 <code>seq</code>，序号，这样可以保证另一方接受到后知道如何排序，但是如果发送必须都是同步的，想象，<code>A</code> 给 <code>B</code> 发送的时候，需要给 B 1，2，3，4，5 个包，发了 1 后，死等 1 的 ack 回来，再给 2，死等 2 的 ack 回来，在 <code>linux</code> 下每个 <code>tcp</code> 的 <code>timeout</code> 最大是 <code>2^5 - 1 = 63s</code>(默认的 <code>retrytime</code> 是 <code>5</code> 次)的时间，因为当发了一个包出去后，在一定时间内没收到 <code>ACK</code> 回应，为了确认不能丢包的问题，会启动重试机制，重试 <code>5</code> 次，它们的延迟分别是：1 秒、3 秒、7 秒、15 秒、31 秒，其中 31s 是前 5 次重试的时间 1+2+4+8+16=31s，最后的 32s 是等待最后一次重试也超时(等待的时间是 2 的 N 次方秒)，所以一共就是 63s，如果一个一个等，是不是有点太恐怖了，万一网络环境比较差，所以为了能在不丢包的情况下，尽量减少时间的损耗，引入了滑动窗口的概念，window</p> <p>由于窗口由 16 位 bit 所定义，所以接收端 <code>TCP</code>，窗口能最大提供 <code>65535</code> 个字节的缓冲，其实这个滑动窗口主要就是做限流和缓冲用的，每一个 <code>tcp</code> 传输中的 <code>win</code> 提供的是对方的窗口大小，当 A 向 B 发数据的时候，超过 B 的 win 长度的数据会被丢掉，同时窗口还可以提高发送数据的效率，通过类似于并发的行为，如下图：</p> <p><img src="/./images/1677d7efaa916ab3.png" alt=""></p> <p>可以看到 <code>A</code> 向 <code>B</code> 连续发了 3 条数据，但是回应 B 的 ACK 没有变，也就是说都是回应同一个 <code>B</code> 的同一个响应，但是 <code>A</code> 自己的 <code>seq</code> 更新了 3 次，先是 1，然后是 69 最后是 <code>1521</code>，说明这三个包是连续发出去的，实际上只要当前数据包的大小不超过对方的 window 大小，就可以连续发的，接着看：</p> <p><img src="/blog/assets/img/1677d7f11f57f146.8693611b.png" alt=""></p> <p>这四个是 B 响应给 A 的数据包，可以看到都是在响应 A 给的数据包，注意看因为 A 连续发了好几条，B 可能一下反应不过来，所以 B 会把这些信息放到缓冲区，但是放的数据越多，那么自己的缓冲区就越小，就是通过 B 自己的 win 来体现，我们可以看到 B 的 win 再连续变小，说明它还没处理好，到第 4 条信息的时候，我们看到 B 给了一个信息叫 <code>WINDOW UPDATE</code> 然后发现 B 的 win 变大了，这就意味着它已经处理好 A 之前连续发的几个数据包了，然后就会重新更新自己的 win 的大小，要注意的是当 tcp 一端的 win 接近或者等于 0 的时候，传输将会停止，直到 <code>window update</code> 更新说 <code>buffer</code> 已经清空了，传输才会继续。</p> <h3 id="丢包"><a href="#丢包" class="header-anchor">#</a> 丢包？</h3> <p>看下面这个图</p> <p><img src="/blog/assets/img/1677d7f312899bfc.6f88ff46.png" alt=""></p> <p>明显能看到 <code>ACK</code> 是连续变大的，在一次连接中，不可能存在说先回复 <code>ACK=3922</code> 然后再回复 <code>ACK=3913</code>，这样的话另一端在收到 <code>3922</code> 的时候就认为之前的全部接收到了，实际上 <code>3913</code> 还没收到，要注意 <code>SeqNum</code> 和 <code>Ack</code> 是以字节数为单位，所以 ack 的时候，不能跳着确认，只能确认最大的连续收到的包。那么，考虑以下情况，假如 A 给的分别是 1，2，3，4 到 5 5 个包，B 这边收到 1，Ack 一个 2（代表收到 1 了），然后 2 丢了，3、4 和 5 收到了，能直接 ACK = 6 吗？当然不行，这样的话 tcp 就是不稳定的了，考虑超时重传的 2 种方案：</p> <ol><li>timeout 后只重新传 2；</li> <li>timeout 后重新给 2、3、4、5；</li></ol> <p>2 种方案有好有坏，第一种比较慢，第二种浪费带宽，所以 <code>tcp</code> 引入了一种快速超时重试机制(<code>Fast Retransmit</code> 算法)，不以时间计算，而以数据做驱动重新传送，如果包没有连续到达，比如 1 到了，2 没到，3，4，5 也到了，这个时候，B 始终返回 <code>ACK=2</code>，代表只确认 1，然后 A 就知道 2 没到，重新发 2，但是 B 一旦收到 2 会直接 <code>ACK=6</code> 给 A，这个的意思就是说 2 拿到后，345 也收到了，直接给 6 就 ok，如下图：</p> <p><img src="data:image/png;base64,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" alt=""></p> <p>上面说的只是一种特别简单的方案，目前，linux2.4 之后，采用了一种更先进的方式，有想了解的可以走<a href="https://coolshell.cn/articles/11564.html" target="_blank" rel="noopener noreferrer">这里<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="攻击"><a href="#攻击" class="header-anchor">#</a> 攻击</h3> <p>典型的场景是 DDOS 攻击，也可以说是 tcp 的 SYN Flood 攻击，又叫洪水攻击；</p> <p>根据上面的分析，我们知道 tcp 的握手环节是比较耗时的，当 client 端发起连接请求的时候，server 端会回应，然后等待 client 的最终确认信息，默认情况下的 linux 会等待 1 到 63s 这样(如果有特殊的设置，这个时间可以到 1-2min 这样)，默认最长是 63s 之后才会断开，之前这段时间内属于半连接的状态，服务器不会丢弃掉这些连接，而是会等，试想如果有一个人突然想你的 server 瞬间之内发送了几千万个连接请求，但是对服务端的响应不做理睬，这样很容易就导致我们正常的 tcp 连接进不去，从而出现服务拒绝的情况，而他只需要一个简简单单的脚本去给你丢包就可以了，这种情况就会导致服务器对正常的客户端表现为宕机。。</p> <p>此种攻击的成本比较低，但是防护却特别麻烦，因为你必须要保证正常的不能因为访问次数的提高而出现拒绝。</p></div> <footer><!----> <hr> <!----></footer></article> <div class="sticker vuepress-toc"><div class="vuepress-toc-item vuepress-toc-h2 active"><a href="#参考资料" title="参考资料">参考资料</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#html-你认为-table-的作用和优缺点是什么呢" title="[html] 你认为 table 的作用和优缺点是什么呢？">[html] 你认为 table 的作用和优缺点是什么呢？</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#table-布局" title="table 布局">table 布局</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#css-解释下-css-sprites-的原理和优缺点分别是什么" title="[css] 解释下 CSS sprites 的原理和优缺点分别是什么？">[css] 解释下 CSS sprites 的原理和优缺点分别是什么？</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#_1-简介" title="1. 简介">1. 简介</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#_2-优点" title="2. 优点">2. 优点</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#_3-缺点" title="3.缺点">3.缺点</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#js-typeof-abc-和-typeof-abc-都是-string-那么-typeof-是操作符还是函数" title="[js] typeof('abc')和 typeof 'abc'都是 string, 那么 typeof 是操作符还是函数？">[js] typeof('abc')和 typeof 'abc'都是 string, 那么 typeof 是操作符还是函数？</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#谈谈你对-tcp-三次握手和四次挥手的理解" title="谈谈你对 TCP 三次握手和四次挥手的理解">谈谈你对 TCP 三次握手和四次挥手的理解</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#base" title="base">base</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#抓包" title="抓包">抓包</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#tcp-base" title="tcp base">tcp base</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#三次握手-敲黑板" title="三次握手(敲黑板)">三次握手(敲黑板)</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#四次挥手" title="四次挥手">四次挥手</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#如何理解滑动窗口的作用" title="如何理解滑动窗口的作用？">如何理解滑动窗口的作用？</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#丢包" title="丢包？">丢包？</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#攻击" title="攻击">攻击</a></div></div></div></div> <footer class="footer" data-v-3d9deeb8><div class="footer-left-wrap" data-v-3d9deeb8><ul class="contact" data-v-3d9deeb8><li class="contact-item" data-v-3d9deeb8><a href="https://github.com/Atrist" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-3d9deeb8><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github" data-v-3d9deeb8><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22" data-v-3d9deeb8></path></svg>
          
        </a></li></ul></div> <div class="footer-right-wrap" data-v-3d9deeb8><ul class="copyright" data-v-3d9deeb8><li class="copyright-item" data-v-3d9deeb8>Copyright © 2018-present</li></ul></div></footer></div><div class="global-ui"><!----><div class="cat-container" data-v-a13867c0><canvas id="vuepress-cat" width="280" height="250" class="live2d" data-v-a13867c0></canvas></div><div class="vuepress-eqn"></div><span class="vuepress-eq"></span></div></div>
    <script src="/blog/assets/js/app.db86d5f6.js" defer></script><script src="/blog/assets/js/14.b92fad15.js" defer></script><script src="/blog/assets/js/4.c843a5e7.js" defer></script><script src="/blog/assets/js/7.a59c3076.js" defer></script>
  </body>
</html>
